<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>lecture 5</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="cs306.html">cs306</a></p>

<ol>
<li><a href="cs306--lectures.html">lectures</a></li>
<ol>
<li><a href="cs306--lectures--lecture_1.html">lecture 1</a></li>
<li><a href="cs306--lectures--lecture_2.html">lecture 2</a></li>
<li><a href="cs306--lectures--lecture_3.html">lecture 3</a></li>
<li><a href="cs306--lectures--lecture_4.html">lecture 4</a></li>
<li><a href="cs306--lectures--lecture_5.html">lecture 5</a></li>
<li><a href="cs306--lectures--lecture_6.html">lecture 6</a></li>
</ol>
<li><a href="cs306--Notes.html">Notes</a></li>
<ol>
<li><a href="cs306--Notes--Block_Cipher_Modes.html">Block Cipher Modes</a></li>
<ol>
<li><a href="cs306--Notes--Block_Cipher_Modes--ECB.html">ECB</a></li>
<li><a href="cs306--Notes--Block_Cipher_Modes--CBC.html">CBC</a></li>
<ol>
<li><a href="cs306--Notes--Block_Cipher_Modes--CBC--Chained_CBC.html">Chained CBC</a></li>
</ol>
<li><a href="cs306--Notes--Block_Cipher_Modes--OFB.html">OFB</a></li>
<li><a href="cs306--Notes--Block_Cipher_Modes--CTR.html">CTR</a></li>
</ol>
<li><a href="cs306--Notes--Stream_Cipher_Modes.html">Stream Cipher Modes</a></li>
<li><a href="cs306--Notes--Encryption.html">Encryption</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--symmetric.html">symmetric</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--symmetric--One_Time_Pad.html">One Time Pad</a></li>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers.html">classical ciphers</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers--Subsitution_Cipher.html">Subsitution Cipher</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers--Subsitution_Cipher--Mono-alphabetic_substituion_cipher.html">Mono-alphabetic substituion cipher</a></li>
</ol>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers--Caesar's_Cipher.html">Caesar's Cipher</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers--Caesar's_Cipher--Shift_Cipher.html">Shift Cipher</a></li>
<li><a href="cs306--Notes--Encryption--symmetric--classical_ciphers--Caesar's_Cipher--Vigenere_cipher.html">Vigenere cipher</a></li>
</ol>
</ol>
<li><a href="cs306--Notes--Encryption--symmetric--Substitution_Boxes.html">Substitution Boxes</a></li>
<li><a href="cs306--Notes--Encryption--symmetric--DES.html">DES</a></li>
<li><a href="cs306--Notes--Encryption--symmetric--AES.html">AES</a></li>
</ol>
<li><a href="cs306--Notes--Encryption--asymmetric.html">asymmetric</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--asymmetric--hybrid_encryption.html">hybrid encryption</a></li>
<li><a href="cs306--Notes--Encryption--asymmetric--algorithms.html">algorithms</a></li>
<ol>
<li><a href="cs306--Notes--Encryption--asymmetric--algorithms--El_Gamal.html">El Gamal</a></li>
<li><a href="cs306--Notes--Encryption--asymmetric--algorithms--RSA.html">RSA</a></li>
</ol>
</ol>
</ol>
<li><a href="cs306--Notes--Pseudo_randomness.html">Pseudo randomness</a></li>
<ol>
<li><a href="cs306--Notes--Pseudo_randomness--Linear_congruential_generator.html">Linear congruential generator</a></li>
</ol>
<li><a href="cs306--Notes--Message_Authentication.html">Message Authentication</a></li>
<ol>
<li><a href="cs306--Notes--Message_Authentication--MAC.html">MAC</a></li>
<ol>
<li><a href="cs306--Notes--Message_Authentication--MAC--CBC.html">CBC</a></li>
<li><a href="cs306--Notes--Message_Authentication--MAC--Domain_extension.html">Domain extension</a></li>
<li><a href="cs306--Notes--Message_Authentication--MAC--Fixed_Length.html">Fixed Length</a></li>
<li><a href="cs306--Notes--Message_Authentication--MAC--Hashing.html">Hashing</a></li>
<ol>
<li><a href="cs306--Notes--Message_Authentication--MAC--Hashing--Insecure.html">Insecure</a></li>
<li><a href="cs306--Notes--Message_Authentication--MAC--Hashing--HMAC.html">HMAC</a></li>
</ol>
</ol>
<li><a href="cs306--Notes--Message_Authentication--Digital_Signatures.html">Digital Signatures</a></li>
<ol>
<li><a href="cs306--Notes--Message_Authentication--Digital_Signatures--Asymmetric-key_message_authentication.html">Asymmetric-key message authentication</a></li>
<li><a href="cs306--Notes--Message_Authentication--Digital_Signatures--RSA.html">RSA</a></li>
</ol>
</ol>
<li><a href="cs306--Notes--Authenticated_encryption.html">Authenticated encryption</a></li>
<ol>
<li><a href="cs306--Notes--Authenticated_encryption--Encrypt-and-authenticate.html">Encrypt-and-authenticate</a></li>
<li><a href="cs306--Notes--Authenticated_encryption--Authenticate-then-encrypt.html">Authenticate-then-encrypt</a></li>
<li><a href="cs306--Notes--Authenticated_encryption--Encrypt-then-authenticate.html">Encrypt-then-authenticate</a></li>
</ol>
<li><a href="cs306--Notes--Hashes.html">Hashes</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Constructing.html">Constructing</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Constructing--Merkle-Damgard.html">Merkle-Damgard</a></li>
<li><a href="cs306--Notes--Hashes--Constructing--Davies-Meyer.html">Davies-Meyer</a></li>
</ol>
<li><a href="cs306--Notes--Hashes--Functions.html">Functions</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Functions--MD5.html">MD5</a></li>
<li><a href="cs306--Notes--Hashes--Functions--SHA1.html">SHA1</a></li>
<li><a href="cs306--Notes--Hashes--Functions--SHA2.html">SHA2</a></li>
<li><a href="cs306--Notes--Hashes--Functions--SHA3.html">SHA3</a></li>
</ol>
<li><a href="cs306--Notes--Hashes--Applications.html">Applications</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Applications--MAC.html">MAC</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Applications--MAC--Insecure.html">Insecure</a></li>
<li><a href="cs306--Notes--Hashes--Applications--MAC--HMAC.html">HMAC</a></li>
</ol>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage.html">Cloud Storage</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage--Plain.html">Plain</a></li>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage--Secure.html">Secure</a></li>
<ol>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage--Secure--whole_file.html">whole file</a></li>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage--Secure--separate_file.html">separate file</a></li>
<li><a href="cs306--Notes--Hashes--Applications--Cloud_Storage--Secure--merkle_tree.html">merkle tree</a></li>
</ol>
</ol>
<li><a href="cs306--Notes--Hashes--Applications--Digital_Envelops_-_Commitment_Schemes.html">Digital Envelops / Commitment Schemes</a></li>
<li><a href="cs306--Notes--Hashes--Applications--Forward-secure_key_rotation.html">Forward-secure key rotation</a></li>
<li><a href="cs306--Notes--Hashes--Applications--File_Identifiers.html">File Identifiers</a></li>
</ol>
</ol>
<li><a href="cs306--Notes--Attacks.html">Attacks</a></li>
<li><a href="cs306--Notes--Types_of_Security.html">Types of Security</a></li>
</ol>
<li><a href="cs306--Labs.html">Labs</a></li>
<ol>
<li><a href="cs306--Labs--Lab_3.html">Lab 3</a></li>
</ol>
<li><a href="cs306--homework.html">homework</a></li>
</ol></div>
<div class="page"><h1><b><u>lecture 5</u></b></h1><h2>Strengthening computational EAV security</h2><br />• PPT adversary can learn the ciphertext of any plaintext of its choice<br />• no PPT adversary can distinguish c<sub>0</sub>, c<sub>1</sub> non-negligibly better than guessing even with extra information<br />• Pr[b' = b] = 1/2 + negl<br />• *randomized encryption is needed<br /><br /><h2>Strengthening vs weakening security</h2><br />• strengthening - assume attacker is more powerful<br />   ◇ e.g. they learn encrypted chosen-plaintext messages<br />• weakening - restricting the attacker to be less general<br />   ◇ e.g. same-length messages<br />• Pr[b' = b] = 1/2 + negl<br /><br /><h2>Hash Functions</h2><br /><img src="images\37-1.png" alt="images\37-1.png" /><br /><h3>MD5 - Message Digest Algorithm</h3><br />• output 128 bits, collision resistance<br />• completely broken<br />• collisions can be found in less than a minute<br />• widely used in legacy applications<br /><br /><h3>SHA1 - Secure Hash Algorithm</h3><br />• output 160 bits<br />• considered insecure for collision resistance<br />• broken<br /><br /><h3>SHA2</h3><br />• outputs 224, 256, 384, 512 bits<br />• no security concerns yet<br />• based on Merkle-Damgard and Davies Meyer generic transforms<br /><br /><h3>SHA3</h3><br />• Completely new philosophy<br />• Sponge construction and un-keyed permutations<br /><br /><h2>Attacks against cryptographic hashing</h2><br />• assume CR compression function h: {0,1}<sup>l'(n)</sup> -&gt; {0, 1}<sup>l(n)</sup><br />• brute force attack<br />   ◇ for each string x in the domain<br />      ▪ compute and record hash value h(x)<br />      ▪ if h(x) = h(y), output collision on x ≠ y<br />   ◇ evaluate h on 2<sup>l(n)</sup> + 1 distinct inputs<br />   ◇ by the pigeon hole principle, at least 1 collision will be found<br />• birthday attack<br />   ◇ more efficient<br />   ◇ uses randomized search rather than exhausting search<br />      ▪ k balls = distinct messages<br />      ▪ m bins = number of possible hash values<br />   ◇ k balls are each independently and randomly thrown into one out m bins<br />   ◇ probability that the i-th ball lands in an empty bin: 1-(i-1)/m<br />   ◇ two balls land in the same bin: Pr[E] = 1-F<sub>k</sub> = 1 - e-k<sup>(k-1)/2m</sup><br />   ◇ approximate number of hash evaluations for finding hash collisions with probability p for varous digest lengths in Bits<br />   ◇ evaluate h on fewer distinct inputs that hash to random values<br />   ◇ probabilistic analysis - at least 1 collision will likely be found<br />   ◇ hashing half distinct inputs -&gt; more likely to find a collision<br />   ◇ to get k-bit security, we at least need hash values of length 2k<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Efficient MAC</h2><br />• secure MAC for messages of arbitrary lengths based on CR hashing<br />• Gen': instantiate H, Mac, output (s, k)<br />• Mac': hash message m into h = H<sup>s</sup>(m), output Mac<sub>k</sub>-tag t on h<br />• Vrfy': canonical verification<br />• Π<sub>mac</sub>' is secure as long as<br />   ◇ H is collision resistant<br />   ◇ Π<sub>mac</sub> is a secure MAC<br /><img src="images\37-2.png" alt="images\37-2.png" /><br /><br /><h3>Insecure MAC based on hashing</h3><br />• tag t = Mac<sub>k</sub>(m) = H(k || m)<br />   ◇ given H(k||m), it should be infeasible to compute H(k || m'), m' ≠ m<br />• insecure construction<br />   ◇ susceptive to length-extension attacks<br />• security vulnerability<br />   ◇ practical CR hash functions are of Merkle Damgard design<br />• length-extension attack<br />   ◇ knowledge of H(m<sub>1</sub>) make it feasible to compute H(m<sub>1</sub> || m<sub>2</sub>)<br />   ◇ knowing of length of message m<sub>1</sub> can retrieve internal state s<sub>k</sub> even without knowing k<br /><img src="images\37-3.png" alt="images\37-3.png" /><br /><br /><h3>HMAC: Secure MAC based on hashing</h3><br />• HMAC<sub>k</sub>[m] = H[ (k ⊕ opad) || H[ (k ⊕ ipad) || m ] ]<br />   ◇ two layers of hashing H<sup>s</sup> - instantiation of hash and sign paradigm<br />• upper layer<br />   ◇ y = H( (k ⊕ ipad) || m )<br />   ◇ y = H'(m)<br />• lower layer<br />   ◇ t = H( (k ⊕ opad) || y' )<br />   ◇ t = Mac'(k<sub>out</sub>y')<br />• if used with a secure hash function and follows specification (key size, correct output), no known practical attacks<br /><img src="images\37-4.png" alt="images\37-4.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Message Digest</h2><br />• Succinct secure description of data - used to detect changes to a block of data<br />• Message Authentication - integrity checking<br />• User authentication - password protection<br />   ◇ used with public-key algorithms for encryption and digital signatures<br />• Main properties of modern cryptographic hash functions<br />   ◇ one way - fast to convert input to a digest but infeasible to infer input of a digest value<br />   ◇ collision-resistance - many collisions exist but they are not obvious to find<br /><br /><h2>Secure Cloud storage</h2><br />• Hashing can be used to<br />   ◇ check integrity of files<br />   ◇ correctness of file searches<br /><h3>• Plain Model</h3><br /><img src="images\37-5.png" alt="images\37-5.png" /><br />***Attacker can send back an altered file<br /><br /><h3>• Secure Cloud Storage Model</h3><br />• <img src="images\37-6.png" alt="images\37-6.png" /><br />• <img src="images\37-7.png" alt="images\37-7.png" /><br />• user has<br />   ◇ authentic digest d<br />   ◇ file F1' to verify<br />   ◇ proof (to help verification)<br />• canonical verification<br />   ◇ combine F1' and the proof to recompute digest d'<br />   ◇ if d' = d - F1 is intact<br /><br /><h3>Hashing files as a whole</h3><br /><img src="images\37-8.png" alt="images\37-8.png" /><br /><h3>Hashing files separately</h3><br /><img src="images\37-9.png" alt="images\37-9.png" /><br /><h3>Merkle Tree</h3><br /><img src="images\37-10.png" alt="images\37-10.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Digital Envelops / Commitment Schemes</h2><br />• Commitment schemes provide two operations<br />   ◇ commit(x,r) = C ------ seal an envelop<br />      ▪ put message x into an evelop using randomness r<br />      ▪ commit (x,r) = h(x || r)<br />      ▪ hiding property - you cannot see through an envelop<br />         - perfect opaqueness<br />         - reveals nothing about message<br />   ◇ open(C,m,r) = ACCEPT/REJECT --- open a sealed envelop<br />      ▪ open envelop using r to check that it has not been tampered with<br />      ▪ open(C, m, r): check if h(x || r) = ?C<br />      ▪ binding property - you cannot change the contents of a sealed envelop<br />         - perfect sealing<br />         - unforgeability - cannot find a cimmitment collision<br /><br /><h3>Online auction</h3><br />• Use digital envelops / commitment schemes<br /><h3>Coin Flip - Who's doing the dishes</h3><br />• Use digital envelops / commitment schemes<br /><br /><h2>Forward-secure key rotation</h2><br />• Keep hashing the symmetric key after every message<br />• If an attack intercepts the messages and breaks into a user's machine, key leakage will only begin after the current key<br />• previous messages will remain safe<br /><img src="images\37-11.png" alt="images\37-11.png" /><br /><br /><h2>File Identifiers</h2><br />• h(f) serves as a unique indentifier for F<br />• one can check whether two files are equal by comparing digests<br /><h3>• Virus fingerprinting</h3><br />   ◇ comparing digest of your files against database of digests of know viruses<br /><h3>• Peer to peer file sharing</h3><br />   ◇ routing tables store values in the hash range for easy lookup of files<br /><h3>• Data deduplication</h3><br />   ◇ don't save duplicates of file. check if hash is already being stored<br />   ◇ saves storage and bandwidth<br /><h3>• Password hashing</h3><br />   ◇ server stores password hashes<br />   ◇ if a password file leaks, passwords are protected because of onewayness<br /><img src="images\37-12.png" alt="images\37-12.png" /><br />   ◇ password space is small and predictable - need to use password salting<br />   ◇ password salting<br />      ▪ slow down dictionary attacks<br />      ▪ salt is appended to a user's password before it is hashed<br />      ▪ salt value is stored in clear along with the hashed password<br />      ▪ two users with the same password will have different hashed passwords<br />      ▪ slows down dictionary attacks<br /><h3>• Digital Signatures and hashing</h3><br />   ◇ Hash and sign<br />   ◇ hash of a message is signed<br />   ◇ signing message M<br />      ▪ let h be a cryptographic hash function, assume RSA setting (n,d,e)<br />      ▪ compute signature σ = h(M)<sup>d</sup> mod n<br />      ▪ send σ, M<br />   ◇ Verifying signature σ<br />   ◇ use public key (e,n)<br />   ◇ compute H = σ<sup>e</sup> mod n<br />   ◇ if H = h(m)<br />      ▪ output ACCEPT<br />      ▪ else output REJECT<br /><br /></div></div>
</body></html>